.PHONY: help
help: ## Show this help message
	@echo "Helm Makefile targets:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'


# Default target for files (can be overridden)
FILES ?= .

## -------------------------------
## ğŸ§¹ Formatting
## -------------------------------

.PHONY: format
format: ## Format YAML and Markdown files (Helm, docs, etc.)
	@echo "format in helm charts not implemented"

## -------------------------------
## ğŸ§© Helm linting
## -------------------------------
.PHONY: lint-helm
lint-helm: ## Run helm lint on all Helm charts
	@echo "ğŸ§­ Running helm lint..."
	@if command -v helm >/dev/null 2>&1; then \
		find . -type f -name Chart.yaml | while read -r chart; do \
			chart_dir=$$(dirname "$$chart"); \
			echo "ğŸ”§ Linting Helm chart: $$chart_dir"; \
			helm lint "$$chart_dir"; \
		done; \
	else \
		echo "âš ï¸  Warning: helm not found. Skipping helm lint."; \
	fi


## -------------------------------
## ğŸ§ª Combined linting
## -------------------------------
.PHONY: lint
lint: lint-helm ## Run all lint checks (format + helm)
	@echo "ğŸ§­ All lint checks passed!"


## -------------------------------
## Skaffold
## -------------------------------
.PHONY: skaffold-dev
skaffold-dev: ## Run skaffold in dev mode
	@echo "ğŸš€ Starting skaffold in dev mode..."
	@skaffold dev --port-forward

