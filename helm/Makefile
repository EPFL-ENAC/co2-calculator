.PHONY: format format-check lint lint-helm


help: ## Show this help message
	@echo "Helm Makefile targets:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'


# Default target for files (can be overridden)
FILES ?= .

## -------------------------------
## 🧹 Formatting
## -------------------------------

format: ## Format YAML and Markdown files (Helm, docs, etc.)
	@echo "do nothing..."

format-check: ## Check formatting without changing files
	@echo "do nothing..."



## -------------------------------
## 🧩 Helm linting
## -------------------------------

lint-helm: ## Run helm lint on all Helm charts
	@echo "🧭 Running helm lint..."
	@if command -v helm >/dev/null 2>&1; then \
		find . -type f -name Chart.yaml | while read -r chart; do \
			chart_dir=$$(dirname "$$chart"); \
			echo "🔧 Linting Helm chart: $$chart_dir"; \
			helm lint "$$chart_dir"; \
		done; \
	else \
		echo "⚠️  Warning: helm not found. Skipping helm lint."; \
	fi


## -------------------------------
## 🧪 Combined linting
## -------------------------------

lint: format-check lint-helm ## Run all lint checks (format + helm)
	@echo "✅ All lint checks passed."
